<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Dish - Bangola Restaurant</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="header-container">Bangola Exquisite African Restaurant</div>
        <nav>
            <ul>
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="menu.html" class="nav-link">Menu</a></li>
                <li><a href="add-dish.html" class="nav-link active">Add Dish</a></li>
            </ul>
        </nav>
    </header>
    
    <main>
        <div class="flex-wrap">
            <h1>Add Your Dish to the Kingdom</h1>
            
            <form id="add-dish-form" class="dish-form">
                <div class="form-group">
                    <label for="dish-name">Dish Name:</label>
                    <input type="text" id="dish-name" name="dish-name" placeholder="e.g. Nyama Choma, Jollof Rice..." required>
                </div>
                
                <div class="form-group">
                    <label for="dish-description">DESCRIPTION - Describe the dish – flavour, tradition, occasion…</label>
                    <textarea id="dish-description" name="dish-description" rows="4" 
                        placeholder="Describe the flavours, cultural significance, when it's typically eaten..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="dish-traditions">Traditions:</label>
                    <input type="text" id="dish-traditions" name="dish-traditions" 
                        placeholder="e.g. Wedding feast, Harvest celebration, Daily meal...">
                </div>
                
                <div class="form-group">
                    <label for="dish-occasion">Occasion:</label>
                    <select id="dish-occasion" name="dish-occasion">
                        <option value="Any">Any occasion</option>
                        <option value="Wedding">Wedding</option>
                        <option value="Festival">Festival</option>
                        <option value="Daily meal">Daily meal</option>
                        <option value="Celebration">Celebration</option>
                        <option value="Religious">Religious ceremony</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group half">
                        <label for="dish-price">PRICE:</label>
                        <input type="text" id="dish-price" name="dish-price" 
                            placeholder="e.g. 85, 400" required>
                    </div>
                    
                    <div class="form-group half">
                        <label for="dish-currency">Currency:</label>
                        <select id="dish-currency" name="dish-currency" required>
                            <option value="USD">USD ($)</option>
                            <option value="KES">KES (KSh)</option>
                            <option value="ZAR">ZAR (R)</option>
                            <option value="BTC">BTC (Bitcoin) ₿</option>
                            <option value="NGN">NGN (₦)</option>
                            <option value="GHS">GHS (₵)</option>
                        </select>
                    </div>
                </div>
                
                <div class="price-examples">
                    <small>Examples: R85, KSh 400, ₿ 0.00015, $12.50</small>
                </div>
                
                <button type="submit" class="submit-btn">Add your dish to the kingdom</button>
            </form>
            
            <div class="recent-preview">
                <h3>Recently added</h3>
                <div id="preview-dishes" class="mini-grid">
                    <!-- Preview of recent dishes will show here -->
                </div>
            </div>
        </div>
    </main>
    
    <footer>
        <p>Bangola Kingdom Restaurant — taste the motherland, every bite tells a story.</p>
        <p>© 2026 | Heritage on a plate</p>
    </footer>

    <script src="js/storage.js"></script>
    <script src="js/ui.js"></script>
    <script>
        // Preview recent dishes on add page
        function showRecentPreview() {
            const preview = document.getElementById('preview-dishes');
            if (!preview) return;
            
            const dishes = loadDishes();
            const recent = dishes.slice(-3).reverse(); // Show 3 most recent
            
            if (recent.length === 0) {
                preview.innerHTML = '<p class="no-dishes">No dishes yet. Add the first one!</p>';
                return;
            }
            
            preview.innerHTML = '';
            recent.forEach(dish => {
                const card = document.createElement('div');
                card.className = 'mini-card';
                
                let currencySymbol = '';
                if (dish.currency === 'BTC') currencySymbol = '₿';
                else if (dish.currency === 'KES') currencySymbol = 'KSh';
                else if (dish.currency === 'ZAR') currencySymbol = 'R';
                else if (dish.currency === 'USD') currencySymbol = '$';
                
                card.innerHTML = `
                    <strong>${dish.name}</strong>
                    <span>${currencySymbol} ${dish.price}</span>
                `;
                preview.appendChild(card);
            });
        }
        
        // Add dish form handler
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Add dish page loaded');
            
            // Show preview
            showRecentPreview();
            
            const form = document.getElementById('add-dish-form');
            
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Get form values
                    const dish = {
                        name: document.getElementById('dish-name')?.value || '',
                        description: document.getElementById('dish-description')?.value || '',
                        tradition: document.getElementById('dish-traditions')?.value || 'Traditional dish',
                        occasion: document.getElementById('dish-occasion')?.value || 'Any',
                        price: document.getElementById('dish-price')?.value || '',
                        currency: document.getElementById('dish-currency')?.value || 'USD'
                    };
                    
                    // Validate
                    if (!dish.name || !dish.description || !dish.price) {
                        alert('Please fill in all required fields');
                        return;
                    }
                    
                    // Save dish
                    if (saveDish(dish)) {
                        alert('✨ Dish added successfully! Thank you for sharing with the kingdom.');
                        form.reset();
                        // Update preview
                        showRecentPreview();
                        // Optional: redirect after short delay
                        setTimeout(() => {
                            if (confirm('Go to home page to see all dishes?')) {
                                window.location.href = 'index.html';
                            }
                        }, 500);
                    } else {
                        alert('Error adding dish. Please try again.');
                    }
                });
            }
            
            // Set active nav if function exists
            if (typeof setActiveNav === 'function') {
                setActiveNav('add-dish.html');
            }
        });
    </script>
</body>
</html>